{% extends 'base.html' %}

{% block title %}Mis Sílabos - Alumno{% endblock %}

{% block sidebar %}
<ul class="nav flex-column">
    <li class="nav-item">
        <a class="nav-link" href="{% url 'presentation:student_dashboard' %}">
            <i class="bi bi-house-door"></i> Dashboard
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{% url 'presentation:student_schedule' %}">
            <i class="bi bi-calendar3"></i> Mi Horario
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{% url 'presentation:student_grades' %}">
            <i class="bi bi-clipboard-data"></i> Mis Notas
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{% url 'presentation:student_syllabus_list' %}">
            <i class="bi bi-file-earmark-text"></i> Sílabos
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{% url 'presentation:student_attendance_list' %}">
            <i class="bi bi-clipboard-check"></i> Asistencia
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{% url 'presentation:student_lab_enrollment' %}">
            <i class="bi bi-pen"></i> Matrícula Laboratorios
        </a>
    </li>
</ul>
{% endblock %}

{% block content %}
<!-- Header -->
<div class="d-flex justify-content-between align-items-center mb-4">
    <div>
        <h1 class="h3 mb-1"><i class="bi bi-file-earmark-text"></i> Mis Sílabos</h1>
        <p class="text-muted">Consulta los sílabos y el avance de tus cursos</p>
    </div>
</div>

<!-- Lista de Sílabos -->
<div class="row">
    {% if courses_with_syllabus %}
        {% for item in courses_with_syllabus %}
        <div class="col-md-6 mb-4">
            <div class="card h-100 shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">
                        <i class="bi bi-book"></i> {{ item.course.course_code }}
                    </h5>
                </div>
                <div class="card-body">
                    <h6 class="card-title">{{ item.course.course_name }}</h6>
                    
                    <!-- Barra de Progreso -->
                    <div class="mb-3">
                        <label for="progress-{{ forloop.counter }}" class="form-label small text-muted">Avance del Curso</label>
                        <div class="progress-wrapper position-relative">
                            <progress 
                                id="progress-{{ forloop.counter }}"
                                value="{{ item.progress|default:0 }}" 
                                max="100"
                                class="w-100 progress-custom 
                                    {% if item.progress >= 75 %}progress-success
                                    {% elif item.progress >= 50 %}progress-info
                                    {% elif item.progress >= 25 %}progress-warning
                                    {% else %}progress-danger{% endif %}" 
                                style="height: 25px;"
                                aria-label="Avance del curso: {{ item.progress|default:0 }}%">
                            </progress>
                            <span class="position-absolute top-50 start-50 translate-middle fw-bold text-white" 
                                style="text-shadow: 0 1px 2px rgba(0,0,0,0.5); font-size: 0.9rem;">
                                {{ item.progress|default:0 }}%
                            </span>
                        </div>
                    </div>
                                        
                    <!-- Información del Curso -->
                    <ul class="list-unstyled mb-3">
                        <li><i class="bi bi-award text-info"></i> <strong>Créditos:</strong> {{ item.course.credits }}</li>
                        <li><i class="bi bi-layers text-warning"></i> <strong>Ciclo:</strong> {{ item.course.cycle }}</li>
                        <li><i class="bi bi-tag text-success"></i> <strong>Tipo:</strong> {{ item.course.get_course_type_display }}</li>
                    </ul>
                    
                    <!-- Botón para ver detalle -->
                    <a href="{% url 'presentation:student_syllabus_detail' item.course.course_id %}" 
                       class="btn btn-primary w-100">
                        <i class="bi bi-eye"></i> Ver Sílabo Completo
                    </a>
                </div>
                <div class="card-footer text-muted small">
                    <i class="bi bi-calendar-check"></i> Cargado: {{ item.syllabus.loaded_at|date:"d/m/Y" }}
                </div>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <div class="col-12">
            <div class="card">
                <div class="card-body text-center py-5">
                    <i class="bi bi-inbox" style="font-size: 4rem; color: #ccc;"></i>
                    <h5 class="mt-3 text-muted">No hay sílabos disponibles</h5>
                    <p class="text-muted">Tus profesores aún no han cargado los sílabos de tus cursos.</p>
                </div>
            </div>
        </div>
    {% endif %}
</div>
{% endblock %}

{% block extra_css %}
<style>
.progress-wrapper {
    display: flex;
    align-items: center;
}

.progress-custom {
    border: none;
    border-radius: 0.375rem;
    background-color: #e9ecef;
}

/* Colores para estados de progreso */
.progress-success::-webkit-progress-value { background-color: #198754; }
.progress-info::-webkit-progress-value { background-color: #0dcaf0; }
.progress-warning::-webkit-progress-value { background-color: #ffc107; }
.progress-danger::-webkit-progress-value { background-color: #dc3545; }

.progress-success::-moz-progress-bar { background-color: #198754; }
.progress-info::-moz-progress-bar { background-color: #0dcaf0; }
.progress-warning::-moz-progress-bar { background-color: #ffc107; }
.progress-danger::-moz-progress-bar { background-color: #dc3545; }

/* Estilo base para la barra de progreso */
.progress-custom::-webkit-progress-bar {
    background-color: #e9ecef;
    border-radius: 0.375rem;
}

.progress-custom::-webkit-progress-value {
    border-radius: 0.375rem;
    transition: all 0.3s ease;
}

.progress-custom::-moz-progress-bar {
    border-radius: 0.375rem;
}
</style>
{% endblock %}